# Vulnerability of amphibians to global warming

This repository contains the data and code to reproduce the results from **Pottier P., Kearney M.R., Wu N.C., Gunderson A.R., Rej J.E., Rivera-Villanueva A.N., Pollo P., Burke S., Drobniak S.M., & Nakagawa S. (2024). Vulnerability of amphibians to global warming.** *In prep* 

We highly recommend navigating this code and repository using `R/Master_file.html`, or this webpage: https://p-pottier.github.io/Vulnerability_amphibians_global_warming/. This rendered version of the code goes through every step of the pipeline, and we recommend users to use headers to navigate this document because it is very large (~35,000 lines of code). At the bottom of the headers of this document, you also have the option to visualize this document using a `light` or `dark` theme.

**However**, `R/Master_file.html` is not entirely reproducible. This code requires extensive computational power and most computations used the computational cluster Katana supported by Research Technology Services at UNSW Sydney (https://research.unsw.edu.au/katana). All code ran on Katana is indicated under each header, along with the location of the specific files one can use to reproduce the results.
Therefore, `R/Master_file.html` is mostly here to walk the reader through the analyses. 

Where one wants to reproduce the analysis, please see the folder `R/`, where the files used to produce these results in an HPC environment are provided. The `pbs/` folder also describes the resources requested to run each R file, and these can be adapted to different supercomputers.

Note that we have not provided climatic data in this repository, but NCEP data can be downloaded at https://psl.noaa.gov/thredds/catalog/Datasets/ncep.reanalysis2/gaussian_grid/catalog.html, while TerraClimate data can be downloaded at https://www.climatologylab.org/terraclimate.html 

While not all `data` and `RData` files are provided in this repository due to memory size limits in Github, all files are available upon request. Please feel free to contact Patrice Pottier (p.pottier@unsw.edu.au) if you have any questions, find mistakes in the code, or if you would like to access specific files. We also recommend contacting us if you are to re-use our data or analyses in other studies.
Note that we will also archive all files to a permanent repository upon journal acceptance.

------------

Below is an overview of the different folders in this repository and their content. 

# **R**
*This folder contains all R code needed to reproduce the results.* 

## Data_wrangling 
*This folder contains all R code to wrangle the data and prepare it for the data imputation and the analysis* 

* `Generating_data_for_imputation.Rmd`: This code is used to prepare the data for the imputation and identify the coordinates at which species occur for the biophysical modeling.
* `Generating_data_for_imputation.Rmd`: This code is used to prepare the data for the imputation cross-validation (where data entries are trimmed to validate the imputation approach).
* `Adjusting_coordinates.R`: This code is used to find the coordinates of the closest land mass to use for biophysical modeling. 
* `Filtering_data_for_arboreal_species.R`: This code is used to filter the data to only arboreal species, and generate coordinates for the biophysical modeling simulating above-ground vegetation.
* `Matching_row_numbers_problematic_locations_arboreal.R`: This code does not need to be run. It was used to identify coordinates in which biophysical models tend to fail.
* `Adding_temperatures_to_data_for_imputation.R`: This code is used to add temperatures, estimated from biophysical models, to the data generated in `Generating_data_for_imputation.Rmd`. This code can only be run once the biophysical models on terrestrial conditions have been completed. 

--------------------------------------------------------------------------------------------------

## Biophysical_modelling  
*This folder contains all R code to run biophysical models.*

### Arboreal
*This folder contains all R code to run biophysical models simulating `arboreal` microhabitats* 

#### --- current ---
*This folder contains all R code to run biophysical models simulating arboreal microhabitats in historical/current microclimates (2006-2015). 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_arboreal_current_climate.R`, which is here to combine the outputs from all batches*

#### --- 2C ---
*This folder contains all R code to run biophysical models simulating arboreal microhabitats in future microclimates assuming two degrees of global warming. 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_arboreal_future_climate_2C.R`, which is here to combine the outputs from all batches*

#### --- 4C ---
*This folder contains all R code to run biophysical models simulating arboreal microhabitats in future microclimates assuming two degrees of global warming. 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_arboreal_future_climate_4C.R`, which is here to combine the outputs from all batches*

---------------------

### Pond
*This folder contains all R code to run biophysical models simulating `aquatic` microhabitats* 
*Because these simulations used the transient heat budget model, they take particularly long to run* 

#### --- current ---
*This folder contains all R code to run biophysical models simulating aquatic microhabitats in historical/current microclimates (2006-2015). 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_pond_current_climate.R`, which is here to combine the outputs from all batches*

#### --- 2C ---
*This folder contains all R code to run biophysical models simulating aquatic microhabitats in future microclimates assuming two degrees of global warming. 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_pond_future_climate_2C.R`, which is here to combine the outputs from all batches*

#### --- 4C ---
*This folder contains all R code to run biophysical models simulating aquatic microhabitats in future microclimates assuming two degrees of global warming. 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_pond_future_climate_4C.R`, which is here to combine the outputs from all batches*

---------------------

### Substrate
*This folder contains all R code to run biophysical models simulating `terrestrial` microhabitats* 

#### --- current ---
*This folder contains all R code to run biophysical models simulating terrestrial microhabitats in historical/current microclimates (2006-2015). 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_substrate_current_climate.R`, which is here to combine the outputs from all batches*

#### --- 2C ---
*This folder contains all R code to run biophysical models simulating terrestrial microhabitats in future microclimates assuming two degrees of global warming. 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_substrate_future_climate_2C.R`, which is here to combine the outputs from all batches*

#### --- 4C ---
*This folder contains all R code to run biophysical models simulating terrestrial microhabitats in future microclimates assuming two degrees of global warming. 
This code was run in batches to optimise memory and time requirements. 
All code can run simultaneously, except `Combining_outputs_substrate_future_climate_4C.R`, which is here to combine the outputs from all batches*

--------------------------------------------------------------------------------------------------

## Imputation 
*This folder contains all R code to perform the data imputation* 

* `Functions_BACE.R`: This file contains the functions that are used to run the data imputation procedure.
* `Running_imputation.R`: This code is used to run the data imputation.
* `Running_cross_validation_1st_set.R`: This code is used to run the first batch of cross-validation.
* `Running_cross_validation_2nd_set.R`: This code is used to run the second batch of cross-validation.
* `Running_cross_validation_3rd_set.R`: This code is used to run the third batch of cross-validation.
* `Running_cross_validation_4th_set.R`: This code is used to run the fourth batch of cross-validation.
* `Running_cross_validation_5th_set.R`: This code is used to run the fifth batch of cross-validation.

--------------------------------------------------------------------------------------------------

## Climate_vulnerability 
*This folder contains all R code to perform the climate vulnerability analyses*

### Arboreal
*This code contains files to run climate vulnerability analyses in `arboreal` microhabitats. These files must run in a certain order* 

*First, we need to add temperature data, calculated from biophysical models, to the species data in each coordinate, using:* 
* `Combining_species_data_with_temp_data_arboreal_current_climate.R`: This code is used to combine temperature data with temperature data estimated in current/historical climates (2006-2015).
* `Combining_species_data_with_temp_data_arboreal_future2C.R`: This code is used to combine temperature data with temperature data estimated in future climates assuming two degrees of global warming. 
* `Combining_species_data_with_temp_data_arboreal_future4C.R`: This code is used to combine temperature data with temperature data estimated in future climates assuming four degrees of global warming. 

*Then, we can predict CTmax across geographical coordinates, accounting for plasticity:* 
* `Predicting_CTmax_across_coordinates_arboreal_current.R`: This code is used to predict CTmax in current/historical climates (2006-2015). 
* `Predicting_CTmax_across_coordinates_arboreal_future2C.R`: This code is used to predict CTmax in future climates assuming two degrees of global warming. 
* `Predicting_CTmax_across_coordinates_arboreal_future4C.R`: This code is used to predict CTmax in future climates assuming four degrees of global warming. 

*Then, we can calculate climate vulnerability metrics:* 
* `Calculating_climate_vulnerability_metrics_arboreal.R`: This code is used to calculate climate vulnerability metrics in all climatic scenarios. 
* `Calculating_climate_vulnerability_metrics_arboreal_sensitivity_analysis.R`: This code is used to calculate climate vulnerability metrics using different assumptions. 

*Finally, we can clip grid cells to match land masses, which is useful when plotting the maps:*
* `Clipping_grid_cells_arboreal.R`: This code is used to clip grid cells of occurrence.

---------------------

### Pond
*This code contains files to run climate vulnerability analyses in `aquatic` microhabitats. These files must run in a certain order* 

*First, we need to add temperature data, calculated from biophysical models, to the species data in each coordinate, using:* 
* `Combining_species_data_with_temp_data_pond_current_climate.R`: This code is used to combine temperature data with temperature data estimated in current/historical climates (2006-2015).
* `Combining_species_data_with_temp_data_pond_future2C.R`: This code is used to combine temperature data with temperature data estimated in future climates assuming two degrees of global warming. 
* `Combining_species_data_with_temp_data_pond_future4C.R`: This code is used to combine temperature data with temperature data estimated in future climates assuming four degrees of global warming. 

*Then, we can predict CTmax across geographical coordinates, accounting for plasticity:* 
* `Predicting_CTmax_across_coordinates_pond_current.R`: This code is used to predict CTmax in current/historical climates (2006-2015). 
* `Predicting_CTmax_across_coordinates_pond_future2C.R`: This code is used to predict CTmax in future climates assuming two degrees of global warming. 
* `Predicting_CTmax_across_coordinates_pond_future4C.R`: This code is used to predict CTmax in future climates assuming four degrees of global warming. 

*Then, we can calculate climate vulnerability metrics:* 
* `Calculating_climate_vulnerability_metrics_pond.R`: This code is used to calculate climate vulnerability metrics in all climatic scenarios. 
* `Calculating_climate_vulnerability_metrics_pond_sensitivity_analysis.R`: This code is used to calculate climate vulnerability metrics using different assumptions. 

*Finally, we can clip grid cells to match land masses, which is useful when plotting the maps:*
* `Clipping_grid_cells_pond.R`: This code is used to clip grid cells of occurrence.


---------------------

### Substrate
*This code contains files to run climate vulnerability analyses in `terrestrial` microhabitats. These files must run in a certain order* 

*First, we need to add temperature data, calculated from biophysical models, to the species data in each coordinate, using:* 
* `Combining_species_data_with_temp_data_substrate_current_climate.R`: This code is used to combine temperature data with temperature data estimated in current/historical climates (2006-2015).
* `Combining_species_data_with_temp_data_substrate_future2C.R`: This code is used to combine temperature data with temperature data estimated in future climates assuming two degrees of global warming. 
* `Combining_species_data_with_temp_data_substrate_future4C.R`: This code is used to combine temperature data with temperature data estimated in future climates assuming four degrees of global warming. 

*Then, we can predict CTmax across geographical coordinates, accounting for plasticity:* 
* `Predicting_CTmax_across_coordinates_substrate_current.R`: This code is used to predict CTmax in current/historical climates (2006-2015). 
* `Predicting_CTmax_across_coordinates_substrate_future2C.R`: This code is used to predict CTmax in future climates assuming two degrees of global warming. 
* `Predicting_CTmax_across_coordinates_substrate_future4C.R`: This code is used to predict CTmax in future climates assuming four degrees of global warming. 

*Then, we can calculate climate vulnerability metrics:* 
* `Calculating_climate_vulnerability_substrate_pond.R`: This code is used to calculate climate vulnerability metrics in all climatic scenarios. 
* `Calculating_climate_vulnerability_substrate_pond_sensitivity_analysis.R`: This code is used to calculate climate vulnerability metrics using different assumptions. 

*Finally, we can clip grid cells to match land masses, which is useful when plotting the maps:*
* `Clipping_grid_cells_substrate.R`: This code is used to clip grid cells of occurrence.


--------------------------------------------------------------------------------------------------

## Models
*This folder contains all R code to run the statistical models*

* `Running_models_CTmax.R`: This code is used to run statistical models using CTmax as the response variable. 
* `Running_models_TSM.R`: This code is used to run statistical models using thermal safety margins (TSM) as the response variable. 
* `Running_models_max_temp.R`: This code is used to run statistical models using maximum operative body temperature as the response variable.
* `Running_models_n_species_overheating.R`: This code is used to run statistical models using the number of species predicted to overheat in each community as the response variable. 
* `Running_models_overheating_days.R`: This code is used to run statistical models using the number of overheating events (days) as the response variable. 
* `Running_models_overheating_days_by_TSM.R`: This code is used to assess the relationship between the number of overheating events (days) and thermal safety margins (TSM). 
* `Running_models_overheating_risk.R`: This code is used to run statistical models using overheating risk as the response variable. 
* `Running_models_prop_species_overheating.R`: This code is used to run statistical models using the proportion of species predicted to overheat in each community as the response variable. 

### Sensitivity_analyses
*This subfolder contains all R code to perform additional sensitivity analyses* 

* `Running_models_CTmax_sensitivity_analysis_max_acc.R`: This code is used to run statistical models using CTmax as the response variable, where animals were acclimated to the mean maximum weekly body temperature. 
* `Running_models_CTmax_sensitivity_analysis_outliers.R`: This code is used to run statistical models using CTmax as the response variable, where outliers falling outside the 5% and 95% percentile were excluded. 
* `Running_models_TSM_sensitivity_analysis_max_acc.R`: This code is used to run statistical models using thermal safety margins (TSM) as the response variable, where animals were acclimated to the mean maximum weekly body temperature.
* `Running_models_TSM_sensitivity_analysis_no_averaging_95th_percentile.R`: This code is used to run statistical models using thermal safety margins (TSM) as the response variable, where TSM was calculated as the difference between the 95% maximum operative body temperature and CTmax. 
* `Running_models_TSM_sensitivity_analysis_no_averaging_max_temp.R`: This code is used to run statistical models using thermal safety margins (TSM) as the response variable, where TSM was calculated as the difference between the maximum operative body temperature and CTmax. 
* `Running_models_TSM_sensitivity_analysis_outliers.R`: This code is used to run statistical models using thermal safety margins (TSM) as the response variable, where outliers falling outside the 5% and 95% percentile were excluded. 
* `Running_models_consecutive_overheating_days.R`: This code is used to run statistical models using the number of consecutive overheating days as the response variable.
* `Running_models_max_temp_sensitivity_analysis_max_acc.R`: This code is used to run statistical models using maximum operative body temperature as the response variable, where animals were acclimated to the mean maximum weekly body temperature. 
* `Running_models_max_temp_sensitivity_analysis_outliers.R`: This code is used to run statistical models using maximum operative body temperature as the response variable, where outliers falling outside the 5% and 95% percentile were excluded. 
* `Running_models_n_species_overheating_sensitivity_analysis_max_acc.R`: This code is used to run statistical models using the number of species predicted to overheat in each community as the response variable, where animals were acclimated to the mean maximum weekly body temperature. 
* `Running_models_n_species_overheating_sensitivity_analysis_strict_estimates.R`: This code is used to run statistical models using the number of species predicted to overheat in each community as the response variable, where overheating events were only counted when operative body temperatures exceeded either 50% or 95% of the predicted distribution of CTmax.
* `Running_models_overheating_days_sensitivity_analysis_max_acc.R`: This code is used to run statistical models using the number of overheating events (days) as the response variable, where animals were acclimated to the mean maximum weekly body temperature.
* `Running_models_overheating_days_sensitivity_analysis_strict_estimates.R`: This code is used to run statistical models using the number of overheating events (days) as the response variable, where overheating events were only counted when operative body temperatures exceeded either 50% or 95% of the predicted distribution of CTmax.
* `Running_models_overheating_risk_sensitivity_analysis_max_acc.R`: This code is used to run statistical models using overheating risk as the response variable, where animals were acclimated to the mean maximum weekly body temperature.
* `Running_models_overheating_risk_sensitivity_analysis_strict_estimates.R`: This code is used to run statistical models using overheating risk as the response variable, where overheating events were only counted when operative body temperatures exceeded either 50% or 95% of the predicted distribution of CTmax.
* `Running_models_prop_species_overheating_sensitivity_analysis_max_acc.R`: This code is used to run statistical models using the proportion of species predicted to overheat in each community as the response variable, where animals were acclimated to the mean maximum weekly body temperature. 
* `Running_models_prop_species_overheating_sensitivity_analysis_strict_estimates.R`: This code is used to run statistical models using the proportion of species predicted to overheat in each community as the response variable, where overheating events were only counted when operative body temperatures exceeded either 50% or 95% of the predicted distribution of CTmax. 

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# **RData**
*This folder contains all code outputs* 

## General_data 
*This folder contains all general data that is used throughout the analyses* 

* `amph_shl_new_Consensus_7238.tre`: Consensus phylogenetic tree from Jetz & Pyron (2018)
* `data_arboreal_sp.rds`: Similar file to `pre_data_for_imputation.rds`, but filtered to arboreal species.
* `data_for_imputation_with_temp.rds`: Data used for the imputation procedure, which includes temperature data estimated from biophysical models.
* `distinct_coordinates.rds`: Distinct coordinates of amphibian geographical occurrence.
* `distinct_coordinates_adj.rds`: Pre-adjusted coordinates of amphibian geographical occurrence (partially matching land masses).
* `distinct_coordinates_adjusted.rds`: Adjusted coordinates of amphibian geographical occurrence, fully adjusted to match land masses.
* `distinct_coordinates_adjusted_arboreal.rds`: Adjusted coordinates of amphibian geographical occurrence, fully adjusted to match land masses, but filtered to arboreal species.
* `pre_data_for_imputation`: Processed data Pottier et al. 2022 that has the same structure as the data used for the imputation; but without the temperature from biophysical models.
* `species_coordinates.rds`: Occurrence of each species in each coordinate of geographical occurrence.
* `species_coordinates_adjusted.rds`: Occurrence of each species in each coordinate of geographical occurrence, fully adjusted to match land masses.
* `species_coordinates_adjusted_arboreal.rds`: Occurrence of each species in each coordinate of geographical occurrence, fully adjusted to match land masses, but filtered to arboreal species.
* `training_data.rds`: Processed data from Pottier et al. 2022, without entries for data-deficient species.

--------------------------------------------------------------------------------------------------

## Climate_vulnerability 
*This folder contains all outputs from climate vulnerability analyses* 

### Arboreal 
*This folder contains all climate vulnerability outputs in `arboreal` microhabitats* 

#### --- current --- 
*This folder contains all climate vulnerability outputs in historical/current microclimates (2006-2015).* 

* `community_vulnerability_arboreal_max_acc_current.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_arboreal_max_acc_current_clipped_cells.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_arboreal_mean_acc_current.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_arboreal_mean_acc_current_clipped_cells.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_arboreal_mean_acc_current_sensitivity_analysis.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_arboreal_max_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_arboreal_mean_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_arboreal_mean_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_arboreal_current.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.

#### --- future2C --- 
*This folder contains all climate vulnerability outputs assuming 2 degrees of global warming above pre-industrial levels* 

* `community_vulnerability_arboreal_max_acc_future2C.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_arboreal_max_acc_future2C_clipped_cells.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_arboreal_mean_acc_future2C.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_arboreal_mean_acc_future2C_clipped_cells.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_arboreal_mean_acc_future2C_sensitivity_analysis.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_arboreal_max_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_arboreal_mean_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_arboreal_mean_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_arboreal_future2C.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.

#### --- future4C --- 
*This folder contains all climate vulnerability outputs assuming 4 degrees of global warming above pre-industrial levels* 

* `community_vulnerability_arboreal_max_acc_future4C.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_arboreal_max_acc_future4C_clipped_cells.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_arboreal_mean_acc_future4C.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_arboreal_mean_acc_future4C_clipped_cells.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_arboreal_mean_acc_future4C_sensitivity_analysis.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_arboreal_max_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_arboreal_mean_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_arboreal_mean_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_arboreal_future4C.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.

---------------------

### Pond
*This folder contains all climate vulnerability outputs in `aquatic` microhabitats* 

#### --- current --- 
*This folder contains all climate vulnerability outputs in historical/current microclimates (2006-2015).* 

* `community_vulnerability_pond_max_acc_current.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_pond_max_acc_current_clipped_cells.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_pond_mean_acc_current.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_pond_mean_acc_current_clipped_cells.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_pond_mean_acc_current_sensitivity_analysis.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_pond_max_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_pond_mean_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_pond_mean_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_pond_current.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.

#### --- future2C --- 
*This folder contains all climate vulnerability outputs assuming 2 degrees of global warming above pre-industrial levels* 

* `community_vulnerability_pond_max_acc_future2C.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_pond_max_acc_future2C_clipped_cells.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_pond_mean_acc_future2C.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_pond_mean_acc_future2C_clipped_cells.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_pond_mean_acc_future2C_sensitivity_analysis.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_pond_max_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_pond_mean_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_pond_mean_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_pond_future2C.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.

#### --- future4C --- 
*This folder contains all climate vulnerability outputs assuming 4 degrees of global warming above pre-industrial levels* 

* `community_vulnerability_pond_max_acc_future4C.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_pond_max_acc_future4C_clipped_cells.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_pond_mean_acc_future4C.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_pond_mean_acc_future4C_clipped_cells.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_pond_mean_acc_future4C_sensitivity_analysis.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_pond_max_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_pond_mean_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_pond_mean_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_pond_future4C.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.


---------------------

### Substrate
*This folder contains all climate vulnerability outputs in `terrestrial` microhabitats* 

#### --- current --- 
*This folder contains all climate vulnerability outputs in historical/current microclimates (2006-2015).* 

* `community_vulnerability_substrate_max_acc_current.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_substrate_max_acc_current_clipped_cells.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_substrate_mean_acc_current.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_substrate_mean_acc_current_clipped_cells.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_substrate_mean_acc_current_sensitivity_analysis.rds`: Community-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_substrate_max_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_substrate_mean_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_substrate_mean_acc_current.rds`: Population-level vulnerability in current/historical microclimates (2006-2015), assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_substrate_current.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.

#### --- future2C --- 
*This folder contains all climate vulnerability outputs assuming 2 degrees of global warming above pre-industrial levels* 

* `community_vulnerability_substrate_max_acc_future2C.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_substrate_max_acc_future2C_clipped_cells.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_substrate_mean_acc_future2C.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_substrate_mean_acc_future2C_clipped_cells.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_substrate_mean_acc_future2C_sensitivity_analysis.rds`: Community-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_substrate_max_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_substrate_mean_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_substrate_mean_acc_future2C.rds`: Population-level vulnerability in future climates assuming two degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_substrate_future2C.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.

#### --- future4C --- 
*This folder contains all climate vulnerability outputs assuming 4 degrees of global warming above pre-industrial levels* 

* `community_vulnerability_substrate_max_acc_future4C.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `community_vulnerability_substrate_max_acc_future4C_clipped_cells.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_substrate_mean_acc_future4C.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `community_vulnerability_substrate_mean_acc_future4C_clipped_cells.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where coordinates were clipped to match land masses for visualization
* `community_vulnerability_substrate_mean_acc_future4C_sensitivity_analysis.rds`: Community-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperature, where climate vulnerability metrics were calculated using different assumptions.
* `population_vulnerability_substrate_max_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean maximum weekly body temperatures. 
* `population_vulnerability_substrate_mean_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures. 
* `population_vulnerability_substrate_mean_acc_future4C.rds`: Population-level vulnerability in future climates assuming four degrees of global warming, assuming animals were acclimated daily to mean weekly body temperatures, where climate vulnerability metrics were calculated using different assumptions.
* `species_ARR_substrate_future4C.rds`: Species-level acclimation response ratios (slope of the association between CTmax and acclimation temperatures) and intercepts.

--------------------------------------------------------------------------------------------------

## Imputation
*This folder contains all outputs from the data imputation* 

### data
* `Data_crossV_1st_set.rds`: Data used for the first batch of the cross-validation procedure
* `Data_crossV_2nd_set.rds`: Data used for the second batch of the cross-validation procedure
* `Data_crossV_3rd_set.rds`: Data used for the third batch of the cross-validation procedure
* `Data_crossV_4th_set.rds`: Data used for the fourth batch of the cross-validation procedure
* `Data_crossV_5th_set.rds`: Data used for the fifth batch of the cross-validation procedure

### results
* `imputation_1st_cycle.Rds`: Results of the first cycle of the main data imputation
* `imputation_2nd_cycle.Rds`: Results of the second cycle of the main data imputation
* `imputation_3rd_cycle.Rds`: Results of the third cycle of the main data imputation
* `imputation_4th_cycle.Rds`: Results of the fourth cycle of the main data imputation
* `imputation_5th_cycle.Rds`: Results of the fifth cycle of the main data imputation
* `1st_cross_validation_1st_cycle.Rds`: Results of the first cycle of the first batch of the cross-validation. 
* `1st_cross_validation_2nd_cycle.Rds`: Results of the second cycle of the first batch of the cross-validation. 
* `1st_cross_validation_3rd_cycle.Rds`: Results of the third cycle of the first batch of the cross-validation. 
* `1st_cross_validation_4th_cycle.Rds`: Results of the fourth cycle of the first batch of the cross-validation. 
* `1st_cross_validation_5th_cycle.Rds`: Results of the fifth cycle of the first batch of the cross-validation. 
* `2nd_cross_validation_1st_cycle.Rds`: Results of the first cycle of the second batch of the cross-validation.
* `2nd_cross_validation_2nd_cycle.Rds`: Results of the second cycle of the second batch of the cross-validation. 
* `2nd_cross_validation_3rd_cycle.Rds`: Results of the third cycle of the second batch of the cross-validation. 
* `2nd_cross_validation_4th_cycle.Rds`: Results of the fourth cycle of the second batch of the cross-validation. 
* `2nd_cross_validation_5th_cycle.Rds`: Results of the fifth cycle of the second batch of the cross-validation. 
* `3rd_cross_validation_1st_cycle.Rds`: Results of the first cycle of the third batch of the cross-validation.
* `3rd_cross_validation_2nd_cycle.Rds`: Results of the second cycle of the third batch of the cross-validation.
* `3rd_cross_validation_3rd_cycle.Rds`: Results of the third cycle of the third batch of the cross-validation.
* `3rd_cross_validation_4th_cycle.Rds`: Results of the fourth cycle of the third batch of the cross-validation.
* `3rd_cross_validation_5th_cycle.Rds`: Results of the fifth cycle of the third batch of the cross-validation.
* `4th_cross_validation_1st_cycle.Rds`: Results of the first cycle of the fourth batch of the cross-validation.
* `4th_cross_validation_2nd_cycle.Rds`: Results of the second cycle of the fourth batch of the cross-validation.
* `4th_cross_validation_3rd_cycle.Rds`: Results of the third cycle of the fourth batch of the cross-validation.
* `4th_cross_validation_4th_cycle.Rds`: Results of the fourth cycle of the fourth batch of the cross-validation.
* `4th_cross_validation_5th_cycle.Rds`: Results of the fifth cycle of the fourth batch of the cross-validation.
* `5th_cross_validation_1st_cycle.Rds`: Results of the first cycle of the fifth batch of the cross-validation.
* `5th_cross_validation_2nd_cycle.Rds`: Results of the second cycle of the fifth batch of the cross-validation.
* `5th_cross_validation_3rd_cycle.Rds`: Results of the third cycle of the fifth batch of the cross-validation.
* `5th_cross_validation_4th_cycle.Rds`: Results of the fourth cycle of the fifth batch of the cross-validation.
* `5th_cross_validation_5th_cycle.Rds`: Results of the fifth cycle of the fifth batch of the cross-validation.

--------------------------------------------------------------------------------------------------

## Models
*This folder contains all outputs from statistical models* 

### CTmax
*This folder contains outputs from models using CTmax as the response variable* 
*There are too many outputs to be described in full here, but here is a guide to understanding the content of each output:* 

* The prefix `model_` was used to capture the model object, the prefix `predictions` for model predictions, and `summary` for the model summary. 
* The type of model is indicated, as either `MCMCglmm` for models running using MCMCglmm, `GAM` for generalized additive model objects, and `MER` for mixed effect regression objects. 
* Models were either run at the population level `pop` or the community level `community`. 
* The suffix `_contrast` was used to indicate models with an intercept, where differences between groups were assessed, whereas other models are without an intercept. 
* The suffixes `_overheating_pop` or `_overheating_communities` were used to refer to models run on subsets of data comprising only the populations or communities experiencing overheating events. 
* Finally, the type of microhabitat is indicated by either `substrate` (terrestrial), `pond` (aquatic), or `arboreal` (arboreal), and the climatic scenario as either `current` (current climate), `future2C` (2 degrees of global warming), or `future4C` (4 degrees of global warming).

#### sensitivity_analyses
*This subfolder contains model outputs for sensitivity analyses. The same conventions as above hold for file names, but there are additional arguments*

* The suffix `_max_acc` was used to refer to analyses assuming animals were acclimated daily to the mean maximum weekly temperature.
* The suffix `_without_outliers` was used to refer to analyses where temperatures falling outside the 5% and 95% percentiles were excluded

---------------------

### TSM
*This folder contains outputs from models using thermal safety margins (TSM) as the response variable* 
*There are too many outputs to be described in full here, but here is a guide to understanding the content of each output:* 

* The prefix `model_` was used to capture the model object, the prefix `predictions` for model predictions, and `summary` for the model summary. 
* The type of model is indicated, as either `MCMCglmm` for models running using MCMCglmm, `GAM` for generalized additive model objects, and `MER` for mixed effect regression objects. 
* Models were either run at the population level `pop` or the community level `community`. 
* The suffix `_contrast` was used to indicate models with an intercept, where differences between groups were assessed, whereas other models are without an intercept. 
* The suffixes `_overheating_pop` or `_overheating_communities` were used to refer to models run on subsets of data comprising only the populations or communities experiencing overheating events. 
* Finally, the type of microhabitat is indicated by either `substrate` (terrestrial), `pond` (aquatic), or `arboreal` (arboreal), and the climatic scenario as either `current` (current climate), `future2C` (2 degrees of global warming), or `future4C` (4 degrees of global warming).

#### sensitivity_analyses
*This subfolder contains model outputs for sensitivity analyses. The same conventions as above hold for file names, but there are additional arguments*

* The suffix `_max_acc` was used to refer to analyses assuming animals were acclimated daily to the mean maximum weekly temperature.
* The suffix `_without_outliers` was used to refer to analyses where temperatures falling outside the 5% and 95% percentiles were excluded
* The suffix `_95th_percentile` was used to refer to analyses where TSM was calculated as the difference between the 95% percentile operative body temperature and the corresponding CTmax.
* The suffix `_max_temp` was used to refer to analyses where TSM was calculated as the difference between the maximum operative body temperature and the corresponding CTmax.

---------------------

### max_temp
*This folder contains outputs from models using maximum operative body temperature as the response variable* 
*There are too many outputs to be described in full here, but here is a guide to understanding the content of each output:* 

* The prefix `model_` was used to capture the model object, the prefix `predictions` for model predictions, and `summary` for the model summary. 
* The type of model is indicated, as either `MCMCglmm` for models running using MCMCglmm, `GAM` for generalized additive model objects, and `MER` for mixed effect regression objects. 
* Models were either run at the population level `pop` or the community level `community`. 
* The suffix `_contrast` was used to indicate models with an intercept, where differences between groups were assessed, whereas other models are without an intercept. 
* The suffixes `_overheating_pop` or `_overheating_communities` were used to refer to models run on subsets of data comprising only the populations or communities experiencing overheating events. 
* Finally, the type of microhabitat is indicated by either `substrate` (terrestrial), `pond` (aquatic), or `arboreal` (arboreal), and the climatic scenario as either `current` (current climate), `future2C` (2 degrees of global warming), or `future4C` (4 degrees of global warming).

#### sensitivity_analyses
*This subfolder contains model outputs for sensitivity analyses. The same conventions as above hold for file names, but there are additional arguments*

* The suffix `_max_acc` was used to refer to analyses assuming animals were acclimated daily to the mean maximum weekly temperature.
* The suffix `_strict50` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 50% of the predicted distribution of CTmax.
* The suffix `_strict95` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 95% of the predicted distribution of CTmax. 

---------------------

### n_species_overheating
*This folder contains outputs from models using the number of species predicted to experience overheating events in each community as the response variable* 
*There are too many outputs to be described in full here, but here is a guide to understanding the content of each output:* 

* The prefix `model_` was used to capture the model object, the prefix `predictions` for model predictions, and `summary` for the model summary. 
* The type of model is indicated, as either `lme4` for models running using lme4, `GAM` for generalized additive model objects, and `MER` for mixed effect regression objects. 
* The suffix `_contrast` was used to indicate models with an intercept, where differences between groups were assessed, whereas other models are without an intercept. 
* The suffix `_overheating_communities` was used to refer to models run on subsets of data comprising only the communities experiencing overheating events. 
* Finally, the type of microhabitat is indicated by either `substrate` (terrestrial), `pond` (aquatic), or `arboreal` (arboreal), and the climatic scenario as either `current` (current climate), `future2C` (2 degrees of global warming), or `future4C` (4 degrees of global warming).

#### sensitivity_analyses
*This subfolder contains model outputs for sensitivity analyses. The same conventions as above hold for file names, but there are additional arguments*

* The suffix `_max_acc` was used to refer to analyses assuming animals were acclimated daily to the mean maximum weekly temperature.
* The suffix `_strict50` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 50% of the predicted distribution of CTmax.
* The suffix `_strict95` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 95% of the predicted distribution of CTmax. 

---------------------

### prop_species_overheating
*This folder contains outputs from models using the proportion of species predicted to experience overheating events in each community as the response variable* 
*There are too many outputs to be described in full here, but here is a guide to understanding the content of each output:* 

* The prefix `model_` was used to capture the model object, the prefix `predictions` for model predictions, and `summary` for the model summary. 
* The type of model is indicated, as either `lme4` for models running using lme4, `GAM` for generalized additive model objects, and `MER` for mixed effect regression objects. 
* The suffix `_contrast` was used to indicate models with an intercept, where differences between groups were assessed, whereas other models are without an intercept. 
* The suffix `_overheating_communities` was used to refer to models run on subsets of data comprising only the communities experiencing overheating events. 
* Finally, the type of microhabitat is indicated by either `substrate` (terrestrial), `pond` (aquatic), or `arboreal` (arboreal), and the climatic scenario as either `current` (current climate), `future2C` (2 degrees of global warming), or `future4C` (4 degrees of global warming).

#### sensitivity_analyses
*This subfolder contains model outputs for sensitivity analyses. The same conventions as above hold for file names, but there are additional arguments*

* The suffix `_max_acc` was used to refer to analyses assuming animals were acclimated daily to the mean maximum weekly temperature.
* The suffix `_strict50` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 50% of the predicted distribution of CTmax.
* The suffix `_strict95` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 95% of the predicted distribution of CTmax. 

---------------------

### overheating_days
*This folder contains outputs from models using the number of overheating days as the response variable* 
*There are too many outputs to be described in full here, but here is a guide to understanding the content of each output:* 

* The prefix `model_` was used to capture the model object, the prefix `predictions` for model predictions, and `summary` for the model summary. 
* The type of model is indicated, as either `lme4` for models running using lme4, `GAM` for generalized additive model objects, and `MER` for mixed effect regression objects. 
* The suffix `_contrast` was used to indicate models with an intercept, where differences between groups were assessed, whereas other models are without an intercept. 
* The suffix `_overheating_pop` was used to refer to models run on subsets of data comprising only the populations experiencing overheating events. 
* Finally, the type of microhabitat is indicated by either `substrate` (terrestrial), `pond` (aquatic), or `arboreal` (arboreal), and the climatic scenario as either `current` (current climate), `future2C` (2 degrees of global warming), or `future4C` (4 degrees of global warming).

#### sensitivity_analyses
*This subfolder contains model outputs for sensitivity analyses. The same conventions as above hold for file names, but there are additional arguments*

* The suffix `_max_acc` was used to refer to analyses assuming animals were acclimated daily to the mean maximum weekly temperature.
* The suffix `_strict50` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 50% of the predicted distribution of CTmax.
* The suffix `_strict95` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 95% of the predicted distribution of CTmax.

---------------------

### overheating_risk
*This folder contains outputs from models using overheating days as the response variable* 
*There are too many outputs to be described in full here, but here is a guide to understanding the content of each output:* 

* The prefix `model_` was used to capture the model object, the prefix `predictions` for model predictions, and `summary` for the model summary. 
* The type of model is indicated, as either `lme4` for models running using lme4, `GAM` for generalized additive model objects, and `MER` for mixed effect regression objects. 
* The suffix `_contrast` was used to indicate models with an intercept, where differences between groups were assessed, whereas other models are without an intercept. 
* Finally, the type of microhabitat is indicated by either `substrate` (terrestrial), `pond` (aquatic), or `arboreal` (arboreal), and the climatic scenario as either `current` (current climate), `future2C` (2 degrees of global warming), or `future4C` (4 degrees of global warming).

#### sensitivity_analyses
*This subfolder contains model outputs for sensitivity analyses. The same conventions as above hold for file names, but there are additional arguments*

* The suffix `_max_acc` was used to refer to analyses assuming animals were acclimated daily to the mean maximum weekly temperature.
* The suffix `_strict50` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 50% of the predicted distribution of CTmax.
* The suffix `_strict95` was used to refer to analyses where overheating events were only counted when operative body temperatures exceeded 95% of the predicted distribution of CTmax.

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# **data** 
*This folder contains data tables that were used for the analyses*

* `Jetz_Pyron_2018_consensus.tre`: Consensus phylogenetic tree from Jetz & Pyron (2018).
* `Jetz_Pyron_metadata_tree.csv`: Metadata for the consensus phylogenetic tree from Jetz & Pyron (2018).
* `data_Johnson_et_al_2023.csv`: Body mass data from Johnson et al. (2023)
* `data_Pottier_et_al_2022.csv`: Thermal tolerance data from Pottier et al. (2022)
* `ecotype_data.csv`: Ecotype data from Wu et al. (2024) *in prep* and authors of this study
* `metadata_Pottier_et_al_2022.csv`: Metadata for the thermal tolerance data from Pottier et al. (2022)
* `tree_for_imputation.tre`: Modified tree from Jetz & Pyron (2018), where the name of some species was changed to match IUCN taxonomic classification. 

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# **pbs** 
*This folder contains pbs files used to run R files in Katana, UNSW's high performance computing environment*
*This folder is organised exactly as the `R/` folder, with the same file names, and hence will not be described further*

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# **fig** 
*This folder contains figure outputs for main figures, extended data figures, and supplementary figures*

