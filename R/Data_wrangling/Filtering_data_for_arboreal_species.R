library(tidyverse)
'%!in%' <- function(x,y)!('%in%'(x,y)) # Function opposite of %in%

# Generate list of coordinates for arboreal species, specifically 
data_for_imp <- readRDS(file="RData/General_data/pre_data_for_imputation.rds")

data_for_imp <- data_for_imp %>%
  mutate(arboreal = ifelse(ecotype == "Arboreal" |
                             second_ecotype == "Arboreal" |
                             second_ecotype == "Semi-arboreal" |
                             second_ecotype == "Semi-Arboreal", "yes", "no")) %>% 
  mutate(arboreal = ifelse(is.na(arboreal)==TRUE, "no", arboreal))

data_arboreal <- filter(data_for_imp, arboreal =="yes")

saveRDS(data_arboreal, file="RData/General_data/data_arboreal_sp.rds")

### Adjust species coordinates 
species_coordinates_adj <- readRDS(file='RData/General_data/species_coordinates_adjusted.rds')
species_coordinates_adj_arboreal <- species_coordinates_adj[species_coordinates_adj$tip.label %in% data_arboreal$tip.label, ]

saveRDS(species_coordinates_adj_arboreal, file="RData/General_data/species_coordinates_adjusted_arboreal.rds")


# Now get list of unique coordinates
distinct_coord <- distinct(dplyr::select(species_coordinates_adj_arboreal, -Presence, -tip.label))
distinct_coord <- distinct_coord %>% rename(x = original_lon, 
                                            y = original_lat)

saveRDS(distinct_coord, file="RData/General_data/distinct_coordinates_adjusted_arboreal.rds")
