
library(tidyverse)

### Daily temperature of the warmest days
daily_temp_warmest_days<- readRDS("RData/Biophysical_modelling/Substrate/current/daily_temp_warmest_days_substrate.rds")

species_occurrence <- readRDS(file="RData/General_data/species_coordinates_adjusted.rds")

### Remove species that are paedomorphic as they live exclusively in water 
pre_data_for_imputation <- readRDS("RData/General_data/pre_data_for_imputation.rds")
pre_data_for_imputation <- dplyr::select(pre_data_for_imputation, tip.label, strategy)
paedomorphic_species <- filter(pre_data_for_imputation, strategy=="Paedomorphic")

species_occurrence <- anti_join(species_occurrence, paedomorphic_species, by = "tip.label")

### Combine datasets 
species_temp_warmest_days <- merge(daily_temp_warmest_days, species_occurrence, by = c("lon", "lat"))

saveRDS(species_temp_warmest_days, file="RData/Biophysical_modelling/Substrate/current/species_daily_temp_warmest_days_substrate_current.rds")
